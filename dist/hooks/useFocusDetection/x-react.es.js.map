{"version":3,"file":"x-react.es.js","sources":["../../../src/hooks/useFocusDetection.ts"],"sourcesContent":["import { useEffect, useRef, useState } from \"react\";\n\nexport interface UseFocusDetectionOptions {\n  onFocus?: (event: FocusEvent) => void;\n  onBlur?: (event: FocusEvent) => void;\n}\n\nconst containsRelatedTarget = (event: FocusEvent): boolean => {\n  if (\n    event.currentTarget instanceof HTMLElement &&\n    event.relatedTarget instanceof HTMLElement\n  ) {\n    return event.currentTarget.contains(event.relatedTarget);\n  }\n  return false;\n};\n\nexport const useFocusDetection = <T extends HTMLElement>({\n  onBlur,\n  onFocus,\n}: UseFocusDetectionOptions = {}): {\n  ref: React.RefObject<T>;\n  focused: boolean;\n} => {\n  const ref = useRef<T>(null);\n  const [focused, setFocused] = useState(false);\n  const focusedRef = useRef(false);\n\n  const _setFocused = (value: boolean): void => {\n    setFocused(value);\n    focusedRef.current = value;\n  };\n\n  useEffect(() => {\n    const handleFocusIn = (event: FocusEvent): void => {\n      if (!focusedRef.current) {\n        _setFocused(true);\n        onFocus?.(event);\n      }\n    };\n\n    const handleFocusOut = (event: FocusEvent): void => {\n      if (focusedRef.current && !containsRelatedTarget(event)) {\n        _setFocused(false);\n        onBlur?.(event);\n      }\n    };\n\n    if (ref.current) {\n      const element = ref.current;\n      element.addEventListener(\"focusin\", handleFocusIn);\n      element.addEventListener(\"focusout\", handleFocusOut);\n\n      return () => {\n        element.removeEventListener(\"focusin\", handleFocusIn);\n        element.removeEventListener(\"focusout\", handleFocusOut);\n      };\n    }\n  }, [onFocus, onBlur]);\n\n  return { ref: ref as React.RefObject<T>, focused };\n};\n"],"names":[],"mappings":";AAOA,MAAM,wBAAwB,CAAC,UAA+B;AAC5D,MACE,MAAM,yBAAyB,eAC/B,MAAM,yBAAyB,aAC/B;AACA,WAAO,MAAM,cAAc,SAAS,MAAM,aAAa;AAAA,EAAA;AAElD,SAAA;AACT;AAEO,MAAM,oBAAoB,CAAwB;AAAA,EACvD;AAAA,EACA;AACF,IAA8B,OAGzB;AACG,QAAA,MAAM,OAAU,IAAI;AAC1B,QAAM,CAAC,SAAS,UAAU,IAAI,SAAS,KAAK;AACtC,QAAA,aAAa,OAAO,KAAK;AAEzB,QAAA,cAAc,CAAC,UAAyB;AAC5C,eAAW,KAAK;AAChB,eAAW,UAAU;AAAA,EACvB;AAEA,YAAU,MAAM;AACR,UAAA,gBAAgB,CAAC,UAA4B;AAC7C,UAAA,CAAC,WAAW,SAAS;AACvB,oBAAY,IAAI;AAChB,2CAAU;AAAA,MAAK;AAAA,IAEnB;AAEM,UAAA,iBAAiB,CAAC,UAA4B;AAClD,UAAI,WAAW,WAAW,CAAC,sBAAsB,KAAK,GAAG;AACvD,oBAAY,KAAK;AACjB,yCAAS;AAAA,MAAK;AAAA,IAElB;AAEA,QAAI,IAAI,SAAS;AACf,YAAM,UAAU,IAAI;AACZ,cAAA,iBAAiB,WAAW,aAAa;AACzC,cAAA,iBAAiB,YAAY,cAAc;AAEnD,aAAO,MAAM;AACH,gBAAA,oBAAoB,WAAW,aAAa;AAC5C,gBAAA,oBAAoB,YAAY,cAAc;AAAA,MACxD;AAAA,IAAA;AAAA,EACF,GACC,CAAC,SAAS,MAAM,CAAC;AAEb,SAAA,EAAE,KAAgC,QAAQ;AACnD;"}